function nomodelImgShow(){$(".imgTab").each(function(){if($(this).hasClass("specs-active")){var i=$(this).attr("bigimg");"null"!=i&&null!=i&&$(".editor-main p img").attr("src",i)}});var i=$(".editor-main img").attr("src");$(".imgTab").on("click",function(){var e=$(this).attr("bigimg");$(this).attr("bigimg")!==$(".editor-main p img").attr("src")?"null"!=e&&null!=e&&$(".editor-main p img").attr("src",e):$(".editor-main p img").attr("src",i)})}function freeModelInit(){Num=1,chooseSize(chooseObj,designData.sizeList,designData.sizeDetail,suidWhere()?designData.suData.suId:null,function(){chooseObj.storeNum<Num?Num=chooseObj.storeNum:Num,$(".panel-number").html(Num),$(".panel-storeNum").html(chooseObj.storeNum),caculatePrice()}),chooseObj.storeNum||$("#goBuyBtn").addClass("disabled").css("background","#aaa"),loadPageSupplierInfo(),commodityListAnimate(),changeBigImg(),signcontroll(),clickSupplier(),buyNum(1,10),addShopCart(),shopCarShelfStatus(),SizeDetailDialog()}function loadPageSupplierInfo(){var i=window.supplierInfo,e="";$.each(i.policy,function(i,t){e+="<li>		    <span><i></i><span>"+t.policyName+"</span></span>		    <div><span></span>"+t.policyDescription+"</div>		</li>"}),$(".supplier_name").html(i._store_name),$(".supplier_StoreDesc").html(i._StoreDesc),$(".supplier_logo_url").attr("src",i._logo_url),$(".supplier_policy").html(e),$(".supplierInfoView").html(i.policyDescription)}function clickSupplier(){$("#supplierInfo").bind("click",function(){$("#companycssreInfo").show(),supplierRating(window.supplierInfo._supplier_id)}),$("#supplierInfoClose").bind("click",function(i){$("#companycssreInfo").hide(),i.stopPropagation()})}function commodityListAnimate(){$(".product_Commodity").bind("click",function(){$(".product_Commodity").removeClass("checked"),$(this).addClass("checked"),$(".product_border").addClass("none"),$(".productInfo").hasClass("checked")&&$(".productInfoView").removeClass("none"),$(".productReview").hasClass("checked")&&($(".productReviewView").removeClass("none"),$(".productReview").attr("show")||ReviewList(designData.ModelId,cpage,pagesize)),$(".supplierInfo").hasClass("checked")&&$(".supplierInfoView").removeClass("none")}),$(".commodityList li").each(function(){$(this).click(function(){$(".checkedLine").animate({left:$(this).attr("data-a")+"px"})})})}function changeBigImg(){$(".editor-main li").click(function(){var i=$(this),e=i.attr("bigimg");i.addClass("main-active").siblings().removeClass("main-active"),e&&$(".editor-main p img").attr("src",e)})}function signcontroll(){var i=$(".signboard");window.designData.isCarve&&($(".signcontentshowC").click(function(){$(this).hide(),i.slideDown(200)}),$(".signBTN").click(function(){321==window.categoryID&&"130089"!=window.supplierInfo._supplier_id?carveSubmitTX():"1300665049"==window.designData.ModelId?carveSubmitKZ():"130082"==window.supplierInfo._supplier_id||"130112"==window.supplierInfo._supplier_id?carveSubmitWJ():"130083"==window.supplierInfo._supplier_id?carveSubmitShengBoHui():"130089"==window.supplierInfo._supplier_id?carveSubmitYiSi():"1300665003"==window.designData.ModelId?carveSubmitBiHui():"1300365007"==window.designData.ModelId||"1300365006"==window.designData.ModelId?carveSubmitViz():7001==window.categoryID?carveSubmitTXD():"130119"==window.supplierInfo._supplier_id?carveSubmitHuaDu():"130065"==window.supplierInfo._supplier_id?carveSubmitSiDi():("1301275001"==window.designData.ModelId||"1301275002"==window.designData.ModelId||"1301275003"==window.designData.ModelId)&&carveSubmitGuCi()}),$(".signboardhide").click(function(){i.slideUp(200,function(){$(".signcontentshowC").show()})}))}function carveSubmitGuCi(){var i=$(".signboard"),e=i.find(".signcontent").val().trim(),t=/^[\u4e00-\u9fa5\s]+$/,n=e.length;if(""!=e&&""!=e.trim()){if(!e.match(t))return void LT.alertSmall("请输入汉字");if(n>2)return void LT.alertSmall("限2个汉字");window.isCarveCustomer=1,LT.alertSmall("签名成功"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),i.slideUp(200)}else 0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),i.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("请输入汉字");window.CarveContent=e,$(".signcontentshow").val(e),caculatePrice()}function carveSubmitWJ(){var i=$(".signboard"),e=i.find(".signcontent").val().trim(),t=/^[a-zA-Z0-9]+$/,n=e.length;if(""!=e&&""!=e.trim()){if(!e.match(t))return void LT.alertSmall("请输入英文字母或数字");if(n>8)return void LT.alertSmall("限8个英文字母或数字");window.isCarveCustomer=1,LT.alertSmall("签名成功"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),i.slideUp(200)}else 0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),i.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("请输入英文字母或数字");window.CarveContent=e,$(".signcontentshow").val(e),caculatePrice()}function carveSubmitKZ(){for(var i,e=$(".signboard"),t=e.find(".signcontent"),n=0,o=/^[a-zA-Z0-9\u4e00-\u9fa5\s]+$/,a="",s=0;s<t.length;s++)if(i=t.eq(s).val().trim()){if(n++,!o.test(i))return void LT.alertSmall("请输入汉字、字母或数字");if(/\s/.test(i))return void LT.alertSmall("不支持输入空格");if(i.length>8)return void LT.alertSmall("每个签字限8个汉字字母或数字");a+=s?";"+i:i}a?(window.isCarveCustomer=1,LT.alertSmall(4==n?"签名成功":"签名成功（您未输全4个签名，价格和4个一致）"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),e.slideUp(200)):0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),e.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("限8个汉字、字母或数字"),window.CarveContent=a,$(".signcontentshow").val(a),caculatePrice()}function carveSubmitSiDi(){var i=$(".signboard"),e=i.find(".signcontent").val().trim(),t=e.split(""),n=/^[a-zA-Z0-9\s]+$/,o=0,a=e.length;if(""!=e&&""!=e.trim()){if(!e.match(n))return void LT.alertSmall("请输入英文字母或数字");if(a>10)return void LT.alertSmall("限10个英文字母或数字");for(var s=0;s<t.length;s++)if(s!=t.length-1&&" "==t[s]&&" "==t[s+1]){o=1;break}if(o)return void LT.alertSmall("不能连续输入空格");window.isCarveCustomer=1,LT.alertSmall("签名成功"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),i.slideUp(200)}else 0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),i.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("请输入英文字母或数字");window.CarveContent=e,$(".signcontentshow").val(e),caculatePrice()}function carveSubmitHuaDu(){var i=$(".signboard"),e=i.find(".signcontent").val().trim(),t=e.split(""),n=/^[a-zA-Z\u4e00-\u9fa5]+$/,o=0;if(""!=e&&""!=e.trim()){if(!e.match(n))return void LT.alertSmall("请输入英文字母或汉字");for(var a=0;a<t.length;a++)o++;if(o>5)return void LT.alertSmall("限5个英文字母或汉字");window.isCarveCustomer=1,LT.alertSmall("签名成功"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),i.slideUp(200)}else 0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),i.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("请输入英文字母或汉字");window.CarveContent=e,$(".signcontentshow").val(e),caculatePrice()}function carveSubmitTX(){var i=$(".signboard"),e=i.find(".signcontent").val().trim(),t=e.split(""),n=/^[a-zA-Z\s]+$/,o=0,a=0;if(""!=e&&""!=e.trim()){if(!e.match(n))return void LT.alertSmall("请输入英文字母");for(var s=0;s<t.length;s++){if(s!=t.length-1&&" "==t[s]&&" "==t[s+1]){o=1;break}" "!=t[s]&&a++}if(o)return void LT.alertSmall("不能连续输入空格");if(a>8)return void LT.alertSmall("限8个英文字母");window.isCarveCustomer=1,LT.alertSmall("签名成功"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),i.slideUp(200)}else 0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),i.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("请输入英文字母");window.CarveContent=e,$(".signcontentshow").val(e),caculatePrice()}function carveSubmitTXD(){var i=$(".signboard"),e=i.find(".signcontent").val().trim(),t=e.split(""),n=/^[a-zA-Z0-9\u4e00-\u9fa5]+$/,o=e.length,a=/^[\u4e00-\u9fa5]+$/,s=0,l=0;if(""!=e&&""!=e.trim()){if(!e.match(n))return void LT.alertSmall("限8个字母和数字，或4个汉字");if(o>8)return void LT.alertSmall("限8个字母和数字，或4个汉字");for(var r=0;r<t.length;r++)a.test(t[r])?s++:l++;if(s>0){if(l>0)return void LT.alertSmall("仅支持纯汉字");if(s>4)return void LT.alertSmall("限8个字母和数字，或4个汉字")}window.isCarveCustomer=1,LT.alertSmall("签名成功"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),i.slideUp(200)}else 0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),i.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("字母数字8个，汉字4个");window.CarveContent=e,$(".signcontentshow").val(e),caculatePrice()}function carveSubmitShengBoHui(){var i=$(".signboard"),e=i.find(".signcontent").val().trim(),t=e.split(""),n=/^[a-zA-Z0-9\s]+$/,o=0,a=e.length;if(""!=e&&""!=e.trim()){if(!e.match(n))return void LT.alertSmall("请输入英文字母或数字");if(a>5)return void LT.alertSmall("限5个英文字母或数字");for(var s=0;s<t.length;s++)if(s!=t.length-1&&" "==t[s]&&" "==t[s+1]){o=1;break}if(o)return void LT.alertSmall("不能连续输入空格");window.isCarveCustomer=1,LT.alertSmall("签名成功"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),i.slideUp(200)}else 0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),i.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("请输入英文字母或数字");window.CarveContent=e,$(".signcontentshow").val(e),caculatePrice()}function carveSubmitViz(){var i=$(".signboard"),e=i.find(".signcontent").val().trim(),t=e.split(""),n=/^[A-Z]+$/;if(""!=e&&""!=e.trim()){if(!e.match(n))return void LT.alertSmall("请输入大写字母");if(t.length>4)return void LT.alertSmall("限4个大写字母");window.isCarveCustomer=1,LT.alertSmall("签名成功"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),i.slideUp(200)}else 0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),i.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("请输入大写字母");window.CarveContent=e,$(".signcontentshow").val(e),caculatePrice()}function carveSubmitBiHui(){var i=$(".signboard"),e=i.find(".signcontent").val().trim(),t=e.split(""),n=/^[a-zA-Z0-9\u4e00-\u9fa5\s]+$/,o=/^[\u4e00-\u9fa5]+$/,a=0,s=0;if(""!=e&&""!=e.trim()){if(!e.match(n))return void LT.alertSmall("仅支持字母、数字和汉字");for(var l=0;l<t.length;l++)o.test(t[l])?s+=2:s++;if(s>16)return void LT.alertSmall("限16个字符，1个汉字算2个字符哦~");for(var l=0;l<t.length;l++)if(l!=t.length-1&&" "==t[l]&&" "==t[l+1]){a=1;break}if(a)return void LT.alertSmall("不能连续输入空格");window.isCarveCustomer=1,LT.alertSmall("签名成功"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),i.slideUp(200)}else 0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),i.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("请输入字母、数字或汉字~");window.CarveContent=e,$(".signcontentshow").val(e),caculatePrice()}function carveSubmitYiSi(){var i=$(".signboard"),e=i.find(".signcontent").val().trim(),t=e.split(""),n=/^[a-zA-Z0-9\u4e00-\u9fa5\s]+$/,o=/^[\u4e00-\u9fa5]+$/,a=0;if(""!=e&&""!=e.trim()){if(!e.match(n))return void LT.alertSmall("仅支持字母、数字和汉字");for(var s=0;s<t.length;s++)o.test(t[s])?a+=2:a++;if(a>15)return void LT.alertSmall("限15个字符，1个汉字算2个字符哦~");window.isCarveCustomer=1,LT.alertSmall("签名成功"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),i.slideUp(200)}else 0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),i.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("请输入字母、数字或汉字~");window.CarveContent=e,$(".signcontentshow").val(e),caculatePrice()}function buyNum(i,e){var t=$(".panel-minus"),n=$(".panel-number"),o=$(".panel-add");t.click(function(){Num>i&&Num--,n.html(Num)}),o.click(function(){chooseObj.storeNum<e?Num<chooseObj.storeNum&&Num++:e>Num&&Num++,n.html(Num)})}function addShopCart(){$("#goBuyBtn").click(function(){var i=$(this);return i.hasClass("disabled")?!1:i.hasClass("masked")?!1:($(this).addClass("masked"),chooseObj.suId?void addToShopCart(i):(i.removeClass("masked"),void LT.alertSmall("请选择规格！")))})}function addToShopCart(i){var e="http://buy.biyao.com",t={halitus:[],sign:[]};window.isCarveCustomer&&t.sign.push({sm:0,pr:designData.productId});var n={su:chooseObj.suId,model:0,supplier:designData.supplierInfo._supplier_id,"package":0,num:Num,payStatus:"0",f_code:"",extendInfo:window.isCarveCustomer?'{"productSigns": [{"carve_id": '+designData.carveInfo.carveId+',"carve_content": "'+window.CarveContent+'"}]}':"{}",performExtends:JSON.stringify(t)};$.ajax({type:"POST",url:e+"/shopcars/addshopcar?",data:n,async:!1,cache:!1,dataType:"jsonp",success:function(t){return i&&i.removeClass("masked"),205017==t?void LT.alertSmall("非常抱歉，原材料不足"):220001==t?void LT.alertSmall("F码无效，请核对后重新输入"):220002==t?void LT.alertSmall("F码已失效"):220003==t?void LT.alertSmall("F码已失效"):220004==t?void LT.alertSmall("F码不能重复使用"):230001==t?void LT.alertSmall("非常抱歉，购买数量超过了剩余数量"):1e5==t?void LT.alertSmall("系统异常"):t?void(window.location.href=e+"/shopcars/index.html"):void LT.alertSmall("购买失败")},error:function(){i&&i.removeClass("masked"),LT.alertSmall("网络异常，购买失败")},complete:function(){i&&i.removeClass("masked")}})}function caculatePrice(){var i=chooseObj.price?chooseObj.price:designData.suData.price,e=chooseObj.duration?chooseObj.duration:designData.suData.duration;window.isCarveCustomer&&(i+=designData.carveInfo.price,e+=designData.carveInfo.duration),$(".totalPrice").html(i),$(".totalDuration").html(e)}function shopCarShelfStatus(){1!=designData.shelfStatus&&$("#goBuyBtn").addClass("disabled").html("<i></i>商品已下架").css("background","#aaa")}function SizeDetailDialog(){var i=$("#SizeDetailDialog");designData.suData.sizeDetail?($("body").append("<img class='none' src='"+designData.suData.sizeDetail+"'>"),i.click(function(){$(this).dialogFn({type:"alert",title:"尺码对照表",width:"560px",btnshow:!1,content:"<img width='560' id='SizeDetailIMG' src='"+designData.suData.sizeDetail+"'>"})})):i.remove()}$(function(){freeModelInit(),document.title=window.designData.suData.suName,nomodelImgShow(),allRating(designData.ModelId)});